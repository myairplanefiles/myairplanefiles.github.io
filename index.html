<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Airplane Files</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="icon" href="https://raw.githubusercontent.com/myairplanefiles/myairplanefiles.github.io/4653f4e49a2ba1501b09e4fe5b551293ea1354ad/Logo.png" type="image/png" />
  <link rel="apple-touch-icon" sizes="180x180" href="AppleLogo.png">

<style>
:root {
  --bg: #f2f2f7;
  --card: rgba(255,255,255,0.75);
  --text: #000;
  --accent: #0a84ff;
}
body.dark { --bg:#0b0b0f; --card:rgba(28,28,30,.8); --text:#fff; }
*{box-sizing:border-box}
html,body{
  overflow:hidden;height:100%;width:100%;touch-action:none;margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",Roboto,sans-serif;
  background:var(--bg);color:var(--text);position:fixed;inset:0;
  transition:background 1.2s ease;
}
#topbar{
  position:fixed;top:10px;left:10px;font-family:Roboto,monospace;font-size:16px;
  background:rgba(255,255,255,.5);padding:8px 12px;border-radius:12px;
  backdrop-filter:blur(12px);z-index:100;line-height:1.4
}
#themeSwitch{
  position:fixed;top:10px;right:10px;font-size:22px;cursor:pointer;
  padding:8px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.25);
  backdrop-filter:blur(12px);background:rgba(255,255,255,.5);z-index:100
}
.screen{
  position:fixed;inset:0;display:flex;justify-content:center;align-items:center;
  padding:0 20px;transform:translateX(120%);
  transition:transform 1.2s cubic-bezier(.2,.9,.15,1)
}
.screen.active{transform:translateX(0)}
.card{
  width:100%;max-width:460px;min-width:320px;background:var(--card);
  backdrop-filter:blur(30px) saturate(160%);border-radius:28px;padding:32px;
  box-shadow:0 40px 80px rgba(0,0,0,.35);text-align:center;
  display:flex;flex-direction:column;align-items:center;justify-content:center
}
.menu{display:grid;gap:12px}
input{width:100%;padding:14px;border-radius:14px;border:none;margin:10px 0;font-size:16px}
button{
  width:100%;padding:15px;border-radius:16px;border:none;
  background:linear-gradient(135deg,#0a84ff,#64d2ff);color:#fff;font-size:17px;
  cursor:pointer;transition:transform .45s ease,box-shadow .45s ease
}
button:hover{transform:scale(1.04);box-shadow:0 12px 30px rgba(10,132,255,.5)}
.small{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.4)}
.viewer-wrap{
  width:100%;max-width:900px;height:88vh;background:var(--card);
  backdrop-filter:blur(30px);border-radius:28px;padding:14px;
  box-shadow:0 40px 80px rgba(0,0,0,.35);display:flex;flex-direction:column;align-items:center
}
iframe,img{width:100%;height:100%;border-radius:18px;border:none;object-fit:contain}
#disclaimer{
  position:fixed;bottom:12px;left:12px;font-size:13px;font-family:Roboto,sans-serif;
  color:rgba(0,0,0,.7);z-index:200
}
#disclaimer a{color:var(--accent);text-decoration:none}
#disclaimer a:hover{text-decoration:underline}
.modal{
  position:fixed;inset:0;background:rgba(0,0,0,.35);
  display:flex;align-items:center;justify-content:center;
  backdrop-filter:blur(10px);opacity:0;pointer-events:none;
  transition:.6s ease;z-index:50
}
.modal.active{opacity:1;pointer-events:auto}
#metarResultBox{
  width:100%;background:rgba(10,132,255,.85);color:#fff;font-family:Roboto,sans-serif;
  font-weight:700;padding:12px;border-radius:16px;margin-bottom:12px;text-align:center
}
</style>
</head>
<body>

<div id="topbar">
  ZULU: <span id="zuluTime">--:--:--</span><br>
  <span id="zuluDate">----</span>
</div>

<div id="themeSwitch" onclick="toggleTheme()">üåó</div>

<div id="disclaimer">
  QRH provided by <a href="https://fenixsim.com" target="_blank">Fenix Simulations</a><br>
  METAR by <a href="https://ourairports.com" target="_blank">ourairports.com</a><br>
  ‚ö†Ô∏è NOT FOR REAL WORLD USE ‚ö†Ô∏è
</div>

<!-- LOGIN -->
<div id="login" class="screen active">
  <div class="card">
    <h1>A320</h1>
    <input id="user" placeholder="Username">
    <input id="pass" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
  </div>
</div>

<!-- MAIN -->
<div id="main" class="screen">
  <div class="card menu">
    <h1>Flight Docs</h1>
    <button onclick="go('qrh')">QRH</button>
    <button onclick="go('checklists')">Checklists</button>
    <button onclick="requestMetar()">METAR</button>
  </div>
</div>

<!-- METAR -->
<div id="metarModal" class="modal">
  <div class="card">
    <h2>METAR</h2>
    <div id="metarResultBox">METAR will appear here</div>
    <input id="icaoInput" placeholder="Enter ICAO (e.g. KJFK)">
    <div style="display:flex;gap:12px;margin-top:12px">
      <button onclick="fetchMetar()">Get METAR</button>
      <button onclick="closeModal('metarModal')">Close</button>
    </div>
  </div>
</div>

<script>
const LOGINACCEPTED=[{user:"CAPI.a",password:"lorenzo1."},{user:"Pilotojesu",password:"PilotojesuOficial!"},{user:"mzattyz",password:"mialovesmatteo"}];
let historyStack=["login"];
function go(id){document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));document.getElementById(id).classList.add("active");historyStack.push(id);}
function login(){if(!LOGINACCEPTED.some(a=>a.user===user.value&&a.password===pass.value)) return alert("Login failed");go("main")}
function toggleTheme(){document.body.classList.toggle("dark")}
function closeModal(id){document.getElementById(id).classList.remove("active")}
function requestMetar(){metarModal.classList.add("active");metarResultBox.innerText="METAR will appear here";icaoInput.value=""}

// ‚úÖ FIXED METAR (OurAirports via AllOrigins)
async function fetchMetar(){
  const icao=icaoInput.value.trim().toUpperCase();
  if(icao.length!==4){metarResultBox.innerText="Invalid ICAO";return}
  metarResultBox.innerText="Fetching METAR‚Ä¶";
  try{
    const proxy="https://api.allorigins.win/raw?url=";
    const url=proxy+encodeURIComponent(`https://ourairports.com/airports/${icao}/weather.html`);
    const res=await fetch(url);
    const html=await res.text();
    const m=html.match(/\b[A-Z]{4}\s+\d{6}Z[\s\S]*?=/);
    metarResultBox.innerText=m?m[0].trim():"METAR not found";
  }catch(e){
    metarResultBox.innerText="Error fetching METAR";
  }
}

// ‚úÖ FIXED ZULU TIME
function updateZulu(){
  const now=new Date();
  document.getElementById("zuluTime").textContent=now.toUTCString().slice(17,25);
  document.getElementById("zuluDate").textContent=now.toISOString().slice(0,10);
}
setInterval(updateZulu,1000);
updateZulu();

// iOS no scroll
document.addEventListener('touchmove',e=>e.preventDefault(),{passive:false});
</script>
</body>
</html>
